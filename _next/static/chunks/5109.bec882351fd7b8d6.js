(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5109],{47029:function(e,t,n){var r;"undefined"==typeof window?n.g:window,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,(function(t){return e[t]}).bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=17)}({17:function(e,t,n){"use strict";n.r(t);var r,o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},s=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},a=anue.shared,u=a.get("constants.endpoints"),c=a.get("constants.keys"),l=a.get("packages.imc"),f=a.get("library.net"),h=a.get("utils.waitty"),d=a.get("utils.urly"),m=a.get("utils.getty"),p=a.get("utils.eventy"),g=a.get("utils.webview"),v="undefined"==typeof document,w=[u.v1User.email.renew(),"/api/v1/user/token/refresh"],y=-1,b=0,S=0,k=function(){function e(t){void 0===t&&(t={});var n=this;this.iid=S++,this.mHost="/",this.removeRequestInspector=null,this.removeResponseInspector=null,this.mProfile=null,this.mSSOToken="",this.mFlag="",this.mStatus="offline",this.mRenewQueuePromise=null,this.mSessionId=-1,this.alwaysSendToken=!1,this.isInWebView=!1,this.isProfileFetching=!1,this.event=new p,this.host=function(e){return n.mHost=e,n},this.isProfileValid=function(e){return!!m(e,["identity_id"])},this.listenChildFrameEvent=function(e){return i(n,void 0,void 0,function(){var t,n;return s(this,function(r){switch(r.label){case 0:r.trys.push([0,4,,5]);try{t=JSON.parse(e.data)}catch(e){return[2]}return"ok"===t.status&&t.token?[4,this.commitLoginSuccess({token:t.token,flag:t.flag})]:[3,2];case 1:return r.sent(),[3,3];case 2:if("error"===t.status)throw t;r.label=3;case 3:return[3,5];case 4:return n=r.sent(),this.emitError({detail:{error:n,childEvent:e},message:"[auth] failed to login with child frame"}),[3,5];case 5:return[2]}})})},this.onStateChange=function(e){return n.event.on(c.Auth.Events.StateChange,e),n},this.onError=function(e){return n.event.on(c.Auth.Events.Error,e),n},this.emitError=function(t){e.trackError(t),n.event.emit(c.Auth.Events.Error,o({},t,{context:n.getCredentialContext()}))},this.emitStateChange=function(e){return i(n,void 0,void 0,function(){return s(this,function(t){return this.event.emit(c.Auth.Events.StateChange,{status:e,flag:this.mFlag,context:this.getCredentialContext()}),[2]})})},this.consumeExisting=function(e){return n.commitLoginSuccess(e),n},this.consume=function(){return i(n,void 0,void 0,function(){var t,n,r,o;return s(this,function(i){switch(i.label){case 0:return t="",n="",anue.urld&&anue.urld.token&&(t=anue.urld.token),t?[3,2]:[4,e.getSSOData()];case 1:t=(r=i.sent()).token,n=r.flag,i.label=2;case 2:return t||(o=/(^#|&)token\=[^\&]+/.exec(location.hash)||/(^\?|&)token\=[^\&]+/.exec(location.search))&&(t=o[0].split("=")[1]),t?[4,this.commitLoginSuccess({token:t,flag:n})]:[3,4];case 3:i.sent(),i.label=4;case 4:return[2,!!t]}})})},this.requestNetworkInspector=function(e){return i(n,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.mSSOToken&&(e.auth||this.alwaysSendToken)&&(e.headers=e.headers||{},e.headers.authorization=e.headers.Authorization||e.headers.authorization||"Bearer "+this.mSSOToken,this.tokenFormatter&&(e.headers.authorization=this.tokenFormatter(e,e.headers.authorization))),[4,e];case 1:return[2,t.sent()]}})})},this.responseNetworkInspector=function(e,t,r){return i(n,void 0,void 0,function(){var n,i,a,u,c;return s(this,function(s){switch(s.label){case 0:return n=e.url,i=m(r,["status"]),a=m(e,["extra","resent"]),u=401===i&&!1===w.reduce(function(e,t){return e||n.indexOf(t)>-1},!1),!a&&u&&this.mSSOToken?[3,2]:[4,t];case 1:return[2,s.sent()];case 2:return[4,this.renew("Auth.Interceptor")];case 3:return s.sent()?(e.extra=o({},e.extra,{resent:!0}),[4,this.requestNetworkInspector(e)]):[3,6];case 4:return c=s.sent(),[4,f.getDriver().send(o({},c,{headers:o({},c.headers,{authorization:"Bearer "+this.mSSOToken})}))];case 5:t=s.sent(),s.label=6;case 6:return[4,t];case 7:return[2,s.sent()]}})})},this.renew=function(e){return i(n,void 0,void 0,function(){var t,n;return s(this,function(r){switch(r.label){case 0:t=null,r.label=1;case 1:return r.trys.push([1,3,,4]),this.mRenewQueuePromise,null===this.mRenewQueuePromise&&(this.mRenewQueuePromise=this.quableRenew(e)),[4,this.mRenewQueuePromise];case 2:if(t=r.sent(),this.mRenewQueuePromise&&(this.mRenewQueuePromise=null),!t)throw{message:"[Auth] failed to renew token",detail:t};return[3,4];case 3:return n=r.sent(),this.emitError(n),[3,4];case 4:return[2,t]}})})},this.quableRenew=function(e){return i(n,void 0,void 0,function(){var e,t,n,r,o,i,a;return s(this,function(s){switch(s.label){case 0:return y=Date.now()+1e3*Math.pow(2,b),Date.now()<y?[4,h(1e3*Math.pow(2,b++))]:[3,2];case 1:s.sent(),s.label=2;case 2:return y=-1,b=1,[4,this.refreshToken()];case 3:return(t=m(e=s.sent(),["items","token"]))?[4,this.commitLoginSuccess({token:t,flag:this.mFlag||""})]:[3,5];case 4:return s.sent(),[3,6];case 5:n="undefined"!=typeof window?location.hostname:"www.cnyes.com",o=(r=/\.(stage\.|gamma\.|beta\.|int\.)(cnyes\.cool)\/?$/.exec(n))?"https://login"+r[0]:"https://login.cnyes.com",this.clearCredentials(),this.emitError({message:"Failed to renew access token, invalid response",detail:e}),location&&(i=location.origin,a=location.pathname,location.href=o+"?aink="+i+a+"&token_expired=1"),s.label=6;case 6:return[2,this.getCredentialContext()]}})})},this.refreshToken=function(){return i(n,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return this.isInWebView?[4,g.get.webViewRefreshToken()]:[3,2];case 1:case 3:return[2,e.sent()];case 2:return[4,f.getDriver().send({method:"POST",url:d(this.mHost,"/api/v1/user/token/refresh"),headers:{authorization:"Bearer "+this.mSSOToken}})]}})})},this.updateEmail=function(e){return i(n,void 0,void 0,function(){var t;return s(this,function(n){switch(n.label){case 0:return[4,f.getDriver().send({method:"POST",url:d(this.mHost,"/api/v1/user/profile/completeEmail"),headers:{authorization:"Bearer "+this.mSSOToken},body:{email:e}})];case 1:return(t=n.sent()).nativeStatus>=400?[2,{error:t}]:this.mProfile?(this.mProfile.email=e,[4,r.rpcCall("storage",["set","profile",JSON.stringify(this.mProfile)])]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2,{}]}})})},this.optimisticallyGetProfile=function(){if(!n.mProfile)try{var e=JSON.parse(localStorage["anue.profile"]);n.mProfile=e}catch(e){}return n.mProfile},this.syncProfileFromLocalStorage=function(){return i(n,void 0,void 0,function(){return s(this,function(t){return[2,e.deSerializeAndValidateProfile(localStorage["anue.profile"])]})})},this.syncProfileFromRPCStorage=function(){return i(n,void 0,void 0,function(){var t;return s(this,function(n){switch(n.label){case 0:return[4,r.rpcCall("storage",["get","profile"])];case 1:return t=n.sent(),[2,e.deSerializeAndValidateProfile(m(t,["data"]))]}})})},this.syncProfileFromRemote=function(e){return i(n,void 0,void 0,function(){var t,n,i,a,u,c,l;return s(this,function(s){switch(s.label){case 0:return t="undefined"!=typeof window?location.hostname:"www.cnyes.com",i=(n=/\.(beta\.|int\.)(cnyes\.cool)\/?$/.exec(t))?"https://member-always-right.api"+n[0]:"https://member-always-right.api.cnyes.com",a=null,this.mSSOToken?!e&&this.isProfileValid(this.mProfile)||this.isProfileFetching?[3,2]:(delete localStorage["anue.profile"],r.rpcCall("storage",["delete","profile"]),this.isProfileFetching=!0,[4,f.getDriver().send({url:i+"/member-always-right/api/v1/user/profile?product="+encodeURIComponent("cnyes"),headers:{authorization:"Bearer "+this.mSSOToken},auth:!0})]):[2,a];case 1:c=m(u=s.sent(),["items","user"]),l={cnyes:m(u,["items","cnyes"]),driver:m(u,["items","driver"]),video:m(u,["items","video"])},a=c&&o({},c,{memberships:l}),s.label=2;case 2:return this.isProfileFetching=!1,this.isProfileValid(a)?[2,a]:[2,null]}})})},this.syncProfile=function(e){return i(n,void 0,void 0,function(){var e,t,n,o,i,a,u;return s(this,function(s){switch(s.label){case 0:for(i in e=[this.syncProfileFromLocalStorage,this.syncProfileFromRPCStorage,this.syncProfileFromRemote],t=null,n=!1,o=[],e)o.push(i);a=0,s.label=1;case 1:return a<o.length?[4,e[o[a]]()]:[3,4];case 2:if(t=s.sent(),n=this.isProfileValid(t))return[3,4];s.label=3;case 3:return a++,[3,1];case 4:return s.trys.push([4,8,,9]),n&&"online"===this.mStatus?(this.mProfile=t,[4,r.rpcCall("storage",["set","profile",JSON.stringify(this.mProfile)])]):[3,6];case 5:return s.sent(),[3,7];case 6:this.emitError({message:"Failed to update profile, invalid response.",detail:t}),s.label=7;case 7:return[3,9];case 8:return u=s.sent(),this.emitError({message:"Failed to update profile, rpc failed.",detail:u}),[3,9];case 9:return[2,this.mProfile]}})})},this.login=function(e){location=n.mHost+"/login"},this.commitLoginSuccess=function(t){return i(n,void 0,void 0,function(){var n,r,o;return s(this,function(i){switch(i.label){case 0:return n=t.token,r=t.flag,o=Math.random()+Date.now(),this.mSessionId=o,n?(this.mFlag=r||"",this.mSSOToken=t.token,this.mStatus="online",this.removeRequestInspector||(this.removeRequestInspector=f.addRequestInterceptor(this.requestNetworkInspector)),this.removeResponseInspector||(this.removeResponseInspector=f.addResponseInterceptor(this.responseNetworkInspector)),o!==this.mSessionId?[3,2]:[4,Promise.all([e.cacheSSOData(this.mSSOToken,this.mFlag),this.syncProfile(o)])]):[2,this];case 1:i.sent(),i.label=2;case 2:return this.emitStateChange("online"),[2,this]}})})},this.clearCredentials=function(){return n.mSSOToken="",n.mProfile=null,n.removeRequestInspector&&n.removeRequestInspector(),n.removeResponseInspector&&n.removeResponseInspector(),n.removeRequestInspector=null,n.removeResponseInspector=null,delete localStorage["anue.profile"],r.rpcCall("storage",["delete","profile"]),e.removeSSOData(),n.emitStateChange("offline"),n.mSessionId=-1,n},this.logout=this.clearCredentials,this.getCredentialContext=function(){return{authorization:n.mSSOToken,flag:n.mFlag,profile:n.mProfile}},this.setAuthToken=function(t,r){void 0===r&&(r=""),t&&(e.cacheSSOData(t,r),n.mSSOToken=t,n.syncProfileFromRemote(!0))},this.setIsInWebView=function(e){n.isInWebView=e};var u=t.host,k=t.token,P=t.isWebView;this.alwaysSendToken=!!t.alwaysSendToken,this.mSSOToken=k||"",this.isInWebView=!!P,this.isProfileFetching=!1,r||v||(r=new(a.get("utils.rpc"))("anue.auth",t.rpcHost||function(){var e="https://login.cnyes.com";if("undefined"==typeof location)return e;if("undefined"!=typeof localStorage&&localStorage["anue.auth.rpchost"])e=localStorage["anue.auth.rpchost"];else{var t=location.host,n=[["dev.int.cnyes.cool","https://login.int.cnyes.cool"],["dev.beta.cnyes.cool","https://login.beta.cnyes.cool"],["int.cnyes.cool","https://login.int.cnyes.cool"],["beta.cnyes.cool","https://login.beta.cnyes.cool"],["gamma.cnyes.cool","https://login.gamma.cnyes.cool"],["stage.cnyes.cool","https://login.stage.cnyes.cool"],["cnyes.com","https://login.cnyes.com"],["int.withgod-test.anue.in","https://login.int.cnyes.cool"],["beta.withgod-test.anue.in","https://login.beta.cnyes.cool"],["stage.withgod-test.anue.in","https://login.stage.cnyes.cool"]];for(var r in n)if(t.indexOf(n[r][0])>-1){e=n[r][1];break}}return e+"/dpi.html"}())),t.formatToken&&(this.tokenFormatter=t.formatToken),window._authToken=function(e){return n.mSSOToken=e},u&&(this.mHost=u),!1!==t.isOpener&&window.addEventListener("message",this.listenChildFrameEvent),!1!==t.imc&&(l.has("auth.getCtx")||(l.register("auth.stateChange",function(e){return i(n,void 0,void 0,function(){return s(this,function(t){return this.onStateChange(e),[2,{data:null}]})})}),l.register("auth.getCtx",function(){return i(n,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,{data:this.getCredentialContext()}];case 1:return[2,e.sent()]}})})}),l.register("auth.consume",function(e){return i(n,void 0,void 0,function(){return s(this,function(t){return this.consumeExisting(e),[2]})})})))}return e.trackError=function(e){var t=a.get("extern.trackjs");t&&t.error(e)},e.getSSOData=function(){return i(void 0,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return[4,r.rpcCall("storage",["get","sso"])];case 1:return(e=t.sent()).data?[2,JSON.parse(e.data)]:[2,{token:"",flag:""}]}})})},e.removeSSOData=function(){return i(void 0,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,r.rpcCall("storage",["delete","sso"])];case 1:return e.sent(),[2]}})})},e.cacheSSOData=function(e,t){return i(void 0,void 0,void 0,function(){var n;return s(this,function(o){switch(o.label){case 0:return n=JSON.stringify({token:e,flag:t}),[4,r.rpcCall("storage",["set","sso",n])];case 1:return o.sent(),[2]}})})},e.deSerializeAndValidateProfile=function(e){try{return JSON.parse(e)}catch(e){}return null},e}();a.set("packages.auth",k),t.default=k}})},e.exports=r()},43619:function(e,t,n){var r;"undefined"==typeof window?n.g:window,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,(function(t){return e[t]}).bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}({7:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this;this.handlers={},this.clear=function(){return e.handlers={}},this.emit=function(t,n){var r=e.handlers[t];r&&r.forEach(function(e){return e(n)})},this.on=function(t,n){return e.handlers[t]=e.handlers[t]||[],e.handlers[t].push(n),function(){var r=e.handlers[t].indexOf(n);r>-1&&e.handlers[t].splice(r,1),n=null}}};anue.shared.set("utils.eventy",r),t.default=r}})},e.exports=r()},40347:function(e,t,n){var r;"undefined"==typeof window?n.g:window,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,(function(t){return e[t]}).bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}({8:function(e,t,n){"use strict";function r(e,t){return Array.isArray(t)?t.reduce(function(e,t){return e&&e[t]},e):null==e?e:e[t]}n.r(t),anue.shared.set("utils.getty",r),t.default=r}})},e.exports=r()},15109:function(e,t,n){"use strict";n.r(t),n.d(t,{Display:function(){return i}});var r,o,i,s,a=n(30748),u=n(47434),c=n(16511),l=n(43633),f=n(74193),h=n(35409),d=n.n(h),m=n(90275),p=n(76687);(r=i||(i={})).FULL="full",r.MINIMIZED="minimized",(o=s||(s={})).Login="login",o.Register="register",o.More="more",o.Close="close",o.Tag="tag",o.Remount="remount";let g=(0,f.z)("div")({name:"Container",class:"c13pm3kq",propsAsIs:!1}),v=(0,f.z)("div")({name:"Mask",class:"m1e4ey52",propsAsIs:!1}),w=e=>{c.C5&&(window.location.href=e)},y=(0,f.z)("div")({name:"Drawer",class:"d1i3fiag",propsAsIs:!1}),b=e=>{e.stopPropagation()};t.default=e=>{let{newsId:t}=e,{isOpenDrawer:n,setIsOpenDrawer:r}=(0,p.Z)(),[o,i]=(0,m.useState)(0),s=()=>{c.C5&&(window.location.href="".concat(u.default.loginLink,"/#?aink=").concat(encodeURIComponent(window.location.href)))},f=()=>{c.C5&&(window.location.href="".concat(u.default.loginLink,"/#/register?aink=").concat(encodeURIComponent(window.location.href)))};return(0,m.useEffect)(()=>{let e=e=>{let t=e.data;if("object"==typeof t&&t.type)switch(t.type){case"login":s();break;case"register":f();break;case"more":r(!0);break;case"close":r(!1);break;case"tag":w(t.message);break;case"remount":i(e=>e+1)}};return window.addEventListener("message",e),(0,l.S1)(),()=>{window.removeEventListener("message",e)}},[r]),(0,a.jsxs)(g,{children:[(0,a.jsx)("iframe",{src:"".concat(u.default.wwwChannelLink,"/static/_newsComment/").concat(t,"?display=","minimized"),title:"comment",width:"100%",height:200,style:{overflow:"hidden"},scrolling:"no"},"news-comment-".concat(o)),(0,a.jsx)(v,{onClick:()=>{r(!1)},className:d()({active:n}),children:(0,a.jsx)(y,{className:d()({active:n}),onClick:b,children:(0,a.jsx)("iframe",{src:"".concat(u.default.wwwChannelLink,"/static/_newsComment/").concat(t),title:"comment",width:"100%",height:"100%",style:{overflow:"hidden"},scrolling:"no"},"news-comment")})})]})},n(15685)},43633:function(e,t,n){"use strict";let r;n.d(t,{Ai:function(){return p},S1:function(){return w},ZP:function(){return k},kS:function(){return b},x4:function(){return y}});var o=n(38139),i=n(38900),s=n(16511),a=n(47029),u=n.n(a),c=n(43619),l=n.n(c);n(40347),n(83268);var f=n(90275);let h=new(l()),d={data:null,status:"init",error:null};function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;h.emit("auth",{type:e,data:t,error:n})}function p(){if(r){var e;let t=null==r?void 0:null===(e=r.getCredentialContext)||void 0===e?void 0:e.call(r);return t&&t.profile?(0,i._)((0,o._)({},t.profile),{nickname:t.profile.nickname||"鉅亨會員",phone_verified:t.profile.phone_verified}):null}return null}let g=!1;async function v(){!r||g||(g=!0,r.onError(e=>{m("error",null,e)}),await r.onStateChange(e=>{"online"===e.status?m("login",e.context):m("logout",null)}).consume()||m("logout",null))}async function w(){let{initAuthToken:e,isWebView:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!r&&s.C5&&(r=new(u())({token:e,flag:t?"AnueAppWebView":"",isWebView:t})).host("".concat("https://member.api.cnyes.com","/member")),r&&r.setAuthToken&&e&&r.setAuthToken(e,t?"AnueAppWebView":""),r&&r.setIsInWebView&&t&&r.setIsInWebView(t),await v()}let y=()=>{if(location){let{origin:e,pathname:t,search:n}=location,r="".concat(e).concat(t);(t.includes("ord_checkout")||t.includes("oauth"))&&(r="".concat(e).concat(t).concat(n)),location.href="".concat("https://login.cnyes.com","?aink=").concat(encodeURIComponent(r))}},b=async()=>{r.clearCredentials()};function S(e,t){let n;switch(t.type){case"login":case"update":n={data:t.data,error:null,status:"login"};break;case"logout":n={data:null,error:null,status:"logout"};break;case"error":n={data:null,error:t.error,status:"logout"};break;default:n=e}return d=n,n}function k(){let[e,t]=(0,f.useReducer)(S,d);return(0,f.useEffect)(()=>h.on("auth",t),[]),[e.status]}},15685:function(e){e.exports={c13pm3kq:"c13pm3kq",m1e4ey52:"m1e4ey52",active:"active",d1i3fiag:"d1i3fiag"}}}]);
//# sourceMappingURL=5109.bec882351fd7b8d6.js.map